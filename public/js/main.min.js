var loginModule=function(){var t=function(){$("#login").on("submit",e)},e=function(t){console.log("Работаем с формой"),t.preventDefault();var e=$(this),n=o(e,"/login");n&&(n.done(function(t){var o=t.mes;"OK"===t.status?(e.trigger("reset"),e.find(".success-mes").text(o).show(),window.location.replace("/")):e.find(".error-mes").text(o).show()}),n.fail(function(t){var o=t.responseJSON,n=t.status;console.log("Ошибка на сервере, код="+n),500===n?e.find(".error-mes").text("На сервере произошла ошибка").show():e.find(".error-mes").text(o.mes).show()}))},o=function(t,e){if(!validation.validateForm(t))return!1;var o=t.serialize();return $.ajax({type:"POST",url:e,dataType:"JSON",data:o})};return{init:function(){console.log("Инициализация модуля loginModule"),t()}}}();$("#login").length&&loginModule.init();var addProject=function(){var t=function(){console.log("Инициализация модуля addProject"),e()},e=function(){$("#add-new-item").on("click",o),$("#add-new-project").on("submit",_addProject)},o=function(){console.log("Вызов модального окна"),$("#new-progect-popup").bPopup({speed:650,transition:"slideDown",onClose:function(){this.find(".form").trigger("reset")}})};return _addProject=function(t){console.log("Работаем с формой добавления проекта"),t.preventDefault();var e=$(this),o=_ajaxForm(this,"/my-work");o&&(o.done(function(t){var o=t.mes;"OK"===t.status?(e.trigger("reset"),e.find(".success-mes").text(o).show(),location.reload()):e.find(".error-mes").text(o).show()}),o.fail(function(t){var o=t.responseJSON,n=t.status;console.log("Ошибка на сервере, код="+n),500===n?e.find(".error-mes").text("На сервере произошла ошибка").show():e.find(".error-mes").text(o.mes).show()}))},_ajaxForm=function(t,e){if(!validation.validateForm($(t)))return!1;var o=new FormData(t);return $.ajax({type:"POST",url:e,data:o,contentType:!1,cache:!1,processData:!1})},{init:t}}();$("#add-new-project").length&&addProject.init();var validation=function(){var t=function(){console.log("Инициализация модуля validation"),o()},e=function(t){console.log("Проверяем форму");var e=t.find("input, textarea").not('input[type="hidden"], input[disabled]'),o=!0;return $.each(e,function(t,e){var n=$(e),e=n.val(),r=n.attr("qtip-position");0===e.length&&(n.addClass("has-error"),i(n,r),o=!1)}),o},o=function(){$("form").on("input",".has-error",n),$("form").on("keydown",".has-error",n),$("form").on("reset",r)},n=function(){console.log("Красная обводка у элементов форм удалена"),$(this).removeClass("has-error")},r=function(t){console.log("Очищаем форму");var t=$(this);t.find(".input, .textarea, .fileupload").trigger("hideTooltip"),t.find(".has-error").removeClass("has-error"),t.find(".error-mes, .success-mes").text("").hide()},i=function(t,e){console.log("Создаем тултип"),e="right"===e?{my:"left center",at:"right center"}:{my:"right center",at:"left center",adjust:{method:"shift none"}},t.qtip({content:{text:function(){return $(this).attr("qtip-content")}},show:{event:"show"},hide:{event:"keydown hideTooltip"},position:e,style:{classes:"qtip-mystyle qtip-rounded",tip:{height:10,width:16}}}).trigger("show")};return{init:t,validateForm:e}}();$("form").length&&validation.init();var contactMe=function(){var t=function(){$("#contact-me").on("submit",e)},e=function(t){console.log("Работаем с формой связи"),t.preventDefault();var e=$(this),n=o(e,"/contact-me");n&&(n.done(function(t){var o=t.mes;"OK"===t.status?(e.trigger("reset"),e.find(".success-mes").text(o).show()):e.find(".error-mes").text(o).show()}),n.fail(function(t){var o=t.responseJSON,n=t.status;console.log("Ошибка на сервере, код="+n),500===n?e.find(".error-mes").text("На сервере произошла ошибка").show():e.find(".error-mes").text(o.mes).show()}))},o=function(t,e){if(!validation.validateForm(t))return!1;var o=t.serialize();return $.ajax({type:"POST",url:e,dataType:"JSON",data:o})};return{init:function(){console.log("Инициализация модуля contactMe"),t()}}}();$("#contact-me").length&&contactMe.init();